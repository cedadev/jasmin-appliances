name: "identity"
label: "Identity Manager"
description: >
  Identity manager for clusters using FreeIPA and Keycloak.
logo: https://user-images.githubusercontent.com/13452123/59352838-8c5b4000-8d19-11e9-9f3c-2de73454f9ab.png

parameters:
  - name: cluster_fixed_ip
    label: "External IP"
    description: The external IP to use for the gateway.
    kind: "cloud.ip"
    immutable: true

  - name: admin_password
    label: "Admin password"
    description: "Password for the `admin` user."
    kind: "string"
    immutable: true
    options:
      secret: true
      confirm: true

  - name: freeipa_server_flavor
    label: FreeIPA size
    description: The size to use for the FreeIPA server.
    kind: "cloud.size"
    immutable: true
    default: 22  # This is j2.small
    options:
      min_ram: 2048
      min_disk: 10

  - name: keycloak_server_flavor
    label: Keycloak size
    description: The size to use for the Keycloak server.
    kind: "cloud.size"
    immutable: true
    default: 22  # This is j2.small
    options:
      min_ram: 1024
      min_disk: 10

  - name: identity_gateway_flavor
    label: Gateway size
    description: The size to use for the gateway server.
    kind: "cloud.size"
    immutable: true
    default: 11  # This is j1.tiny

  - name: gateway_external_domain
    label: Gateway domain
    description: |
      The domain to use for the gateway server (optional).

      If not given, `<ip>.nip.io` will be used. No specific DNS entry is required.

      If given, a DNS entry for the domain pointing to the selected IP
      must already exist. A DNS entry will **not** be created for you,
      and the lack of a correct DNS entry will cause configuration to fail.
    kind: string
    immutable: true
    required: false
